<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>AdminLTE 2 | General Form Elements</title>
  <!-- Tell the browser to be responsive to screen width -->
  <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
  <!-- Bootstrap 3.3.5 -->
  <link rel="stylesheet" href="../../bootstrap/css/bootstrap.min.css">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
  <!-- Ionicons -->
  <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="../../dist/css/AdminLTE.min.css">
    <!-- AdminLTE Skins. Choose a skin from the css/skins
    folder instead of downloading all of them to reduce the load. -->
    <link rel="stylesheet" href="../../dist/css/skins/_all-skins.min.css">
    <link rel="stylesheet" href="entryPrescription.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->
      </head>
      <body class="hold-transition skin-blue sidebar-mini control-sidebar-open">

        <div class="wrapper">

          <header class="main-header">
            <!-- Logo -->
            <a href="../../index2.html" class="logo"  style="width: 13%;">
              <!-- mini logo for sidebar mini 50x50 pixels -->
              <span class="logo-mini"><b>db</b></span>
              <!-- logo for regular state and mobile devices -->
              <span class="logo-lg"><b>dBotica</b></span>
            </a>
            <!-- Header Navbar: style can be found in header.less -->
            <nav class="navbar navbar-static-top" role="navigation"  style="margin-left: 13%;">
              <!-- Sidebar toggle button-->
              <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </a>
              <div class="navbar-custom-menu">
                <ul class="nav navbar-nav">
                  <!-- Messages: style can be found in dropdown.less-->
              <!-- <li class="dropdown messages-menu">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                  <i class="fa fa-envelope-o"></i>
                  <span class="label label-success">4</span>
                </a>
                <ul class="dropdown-menu">
                  <li class="header">You have 4 messages</li>
                  <li>
                    
                    <ul class="menu">
                      <li>
                        <a href="#">
                          <div class="pull-left">
                            <img src="../../dist/img/user2-160x160.jpg" class="img-circle" alt="User Image">
                          </div>
                          <h4>
                            Support Team
                            <small><i class="fa fa-clock-o"></i> 5 mins</small>
                          </h4>
                          <p>Why not buy a new awesome theme?</p>
                        </a>
                      </li>
                      <li>
                        <a href="#">
                          <div class="pull-left">
                            <img src="../../dist/img/user3-128x128.jpg" class="img-circle" alt="User Image">
                          </div>
                          <h4>
                            AdminLTE Design Team
                            <small><i class="fa fa-clock-o"></i> 2 hours</small>
                          </h4>
                          <p>Why not buy a new awesome theme?</p>
                        </a>
                      </li>
                      <li>
                        <a href="#">
                          <div class="pull-left">
                            <img src="../../dist/img/user4-128x128.jpg" class="img-circle" alt="User Image">
                          </div>
                          <h4>
                            Developers
                            <small><i class="fa fa-clock-o"></i> Today</small>
                          </h4>
                          <p>Why not buy a new awesome theme?</p>
                        </a>
                      </li>
                      <li>
                        <a href="#">
                          <div class="pull-left">
                            <img src="../../dist/img/user3-128x128.jpg" class="img-circle" alt="User Image">
                          </div>
                          <h4>
                            Sales Department
                            <small><i class="fa fa-clock-o"></i> Yesterday</small>
                          </h4>
                          <p>Why not buy a new awesome theme?</p>
                        </a>
                      </li>
                      <li>
                        <a href="#">
                          <div class="pull-left">
                            <img src="../../dist/img/user4-128x128.jpg" class="img-circle" alt="User Image">
                          </div>
                          <h4>
                            Reviewers
                            <small><i class="fa fa-clock-o"></i> 2 days</small>
                          </h4>
                          <p>Why not buy a new awesome theme?</p>
                        </a>
                      </li>
                    </ul>
                  </li>
                  <li class="footer"><a href="#">See All Messages</a></li>
                </ul>
              </li> -->
              <!-- Notifications: style can be found in dropdown.less -->
              <!-- <li class="dropdown notifications-menu">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                  <i class="fa fa-bell-o"></i>
                  <span class="label label-warning">10</span>
                </a>
                <ul class="dropdown-menu">
                  <li class="header">You have 10 notifications</li>
                  <li>
                    
                    <ul class="menu">
                      <li>
                        <a href="#">
                          <i class="fa fa-users text-aqua"></i> 5 new members joined today
                        </a>
                      </li>
                      <li>
                        <a href="#">
                          <i class="fa fa-warning text-yellow"></i> Very long description here that may not fit into the page and may cause design problems
                        </a>
                      </li>
                      <li>
                        <a href="#">
                          <i class="fa fa-users text-red"></i> 5 new members joined
                        </a>
                      </li>

                      <li>
                        <a href="#">
                          <i class="fa fa-shopping-cart text-green"></i> 25 sales made
                        </a>
                      </li>
                      <li>
                        <a href="#">
                          <i class="fa fa-user text-red"></i> You changed your username
                        </a>
                      </li>
                    </ul>
                  </li>
                  <li class="footer"><a href="#">View all</a></li>
                </ul>
              </li> -->
              <!-- Tasks: style can be found in dropdown.less -->
              <!-- <li class="dropdown tasks-menu">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                  <i class="fa fa-flag-o"></i>
                  <span class="label label-danger">9</span>
                </a>
                <ul class="dropdown-menu">
                  <li class="header">You have 9 tasks</li>
                  <li>
                   
                    <ul class="menu">
                      <li>
                        <a href="#">
                          <h3>
                            Design some buttons
                            <small class="pull-right">20%</small>
                          </h3>
                          <div class="progress xs">
                            <div class="progress-bar progress-bar-aqua" style="width: 20%" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100">
                              <span class="sr-only">20% Complete</span>
                            </div>
                          </div>
                        </a>
                      </li>
                      <li>
                        <a href="#">
                          <h3>
                            Create a nice theme
                            <small class="pull-right">40%</small>
                          </h3>
                          <div class="progress xs">
                            <div class="progress-bar progress-bar-green" style="width: 40%" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100">
                              <span class="sr-only">40% Complete</span>
                            </div>
                          </div>
                        </a>
                      </li>
                      <li>
                        <a href="#">
                          <h3>
                            Some task I need to do
                            <small class="pull-right">60%</small>
                          </h3>
                          <div class="progress xs">
                            <div class="progress-bar progress-bar-red" style="width: 60%" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100">
                              <span class="sr-only">60% Complete</span>
                            </div>
                          </div>
                        </a>
                      </li>
                      <li>
                        <a href="#">
                          <h3>
                            Make beautiful transitions
                            <small class="pull-right">80%</small>
                          </h3>
                          <div class="progress xs">
                            <div class="progress-bar progress-bar-yellow" style="width: 80%" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100">
                              <span class="sr-only">80% Complete</span>
                            </div>
                          </div>
                        </a>
                      </li>
                    </ul>
                  </li>
                  <li class="footer">
                    <a href="#">View all tasks</a>
                  </li>
                </ul>
              </li> -->
              <!-- User Account: style can be found in dropdown.less -->
                  <li class="dropdown user user-menu">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                      <img src="../../dist/img/user2-160x160.jpg" class="user-image" alt="User Image">
                      <span class="hidden-xs">Doctor 1</span>
                    </a>
                    <ul class="dropdown-menu">
                      <!-- User image -->
                      <li class="user-header">
                        <img src="../../dist/img/user2-160x160.jpg" class="img-circle" alt="User Image">
                        <p>
                          Doctor 1 - Cardiologist
                          <small>Member since Feb 2016</small>
                        </p>
                      </li>
                      <!-- Menu Body -->
                      <li class="user-body">
                        <div class="col-xs-4 text-center">
                          <a href="#">Followers</a>
                        </div>
                        <div class="col-xs-4 text-center">
                          <a href="#">Health Tips</a>
                        </div>
                        <div class="col-xs-4 text-center">
                          <a href="#">Friends</a>
                        </div>
                      </li>
                      <!-- Menu Footer-->
                      <li class="user-footer">
                        <div class="pull-left">
                          <a href="#" class="btn btn-default btn-flat">Profile</a>
                        </div>
                        <div class="pull-right">
                          <a href="#" class="btn btn-default btn-flat">Sign out</a>
                        </div>
                      </li>
                    </ul>
                  </li>
                  <!-- Control Sidebar Toggle Button -->
                  <li>
                    <a href="#" data-toggle="control-sidebar"><i class="fa fa-gears"></i></a>
                  </li>
                </ul>
              </div>
            </nav>
          </header>
          <!-- Left side column. contains the logo and sidebar -->
          <aside class="main-sidebar" style="width: 13%;">

            <!-- sidebar: style can be found in sidebar.less -->
            <section class="sidebar">

              <!-- Sidebar user panel (optional) -->
              <div class="user-panel">
                <div class="pull-left image">
                  <img src="../../dist/img/user2-160x160.jpg" class="img-circle" alt="User Image">
                </div>
                <div class="pull-left info">
                  <p>Doctor 1</p>
                  <!-- Status -->
                  <a href="#"><i class="fa fa-circle text-success"></i> Online</a>
                </div>
              </div>

              <!-- Sidebar Menu -->
              <ul class="sidebar-menu">
                <li class="header">Welcome</li>
                <!-- Optionally, you can add icons to the links -->
                <li class="active"><a href="../forms/entryPrescriptions.html"><i class="fa fa-link"></i> <span>Drug prescription</span></a></li>
                <li><a href="myPrescriptions.html"><i class="fa fa-link"></i> <span>My Prescriptions</span></a></li> 
                <!--  <li class="active"><a href="../forms/PatientSearch.html"><i class="fa fa-link"></i> <span>Patient Search</span></a></li>  -->
                <li class="treeview">
                 <!--  <a href="../tables/data.html"><i class="fa fa-link"></i> <span>Drug database</span> <i class="fa fa-angle-left pull-right"></i></a> -->
                </li>
              </ul><!-- /.sidebar-menu -->
            </section>
            <!-- /.sidebar -->
          </aside>

          <!-- Content Wrapper. Contains page content -->
          <div class="content-wrapper"  style="margin-left: 13%;margin-right: 22%;">
            <!-- Content Header (Page header) -->
            <section class="content-header">
              <h1>
                Prescriptions Form
                <!-- <small>Preview</small> -->
              </h1>
          <!-- <ol class="breadcrumb">
            <li><a href="#"><i class="fa fa-dashboard"></i> Home</a></li>
            <li><a href="#">Forms</a></li>
            <li class="active">General Elements</li>
          </ol> -->
        </section>

        <!-- Main content -->
        <section class="content">
          <div class="row">
           <div class="col-md-14">
             <div class="box-header with-border">
              <h3 class="box-title"></h3>
              <button type="submit" class="btn btn-primary pull-right"  id="prescription-reset" >Reset</button>
            </div><!-- /.box-header -->


          </div>
          <div class="col-xs-12">
            <div class="box box-solid box-primary">
              <div class="box-header">
                <h3 class="box-title">Patient Data</h3>
              </div><!-- /.box-header -->
              <div class="box-body">
               <div class="col-md-3 form-group">
                 <label>Patient Name</label>
                 <span class="form-control" placeholder="Patient Name" value="Type" id="prescription-form-patient-name"  
                 style="background-color: #eee;">
               </span>
             </div>

             <div class="col-md-2 form-group">
              <label>Weight in kgs</label> 
              <input type="text" class="form-control" placeholder="Weight" id="prescription-form-weight">
            </input>
          </div>
          <div class="col-md-2 form-group">
            <label>Height in cms</label>
            <input type="text" class="form-control" placeholder="Height" id="prescription-form-height">
          </input>
        </div>
        <div class="col-md-2 form-group">
          <label>Temperature</label>
          <input type="text" class="form-control" placeholder="Temperature" id="prescription-form-temp">
        </input>
      </div>
        <div class="col-md-3 form-group">
          <label>Blood Pressure</label>
          <input type="text" class="form-control" placeholder="Blood Pressure" id="prescription-form-bloodPressure">
        </input>
      </div>


    </div><!-- /.box-body -->
  </div><!-- /.box -->
</div><!-- /.col -->
</div><!-- /.row -->




</section>




<section class="content">
  <div class="row">

  </div><!--/.col (left) -->

  <!-- right column -->
  <div class="col-md-14">
    <!-- general form elements disabled -->
    <div class="box box-solid box-primary">
      <div class="box-header">
        <h3 class="box-title">Fill Prescription</h3>
      </div>

      <div class="box-body">
        <form role="form" id="prescription-form">
          <div class="col-md-12 form-group">
            <input type="textarea"  class="form-control" rows="2"  placeholder="CLinical Impression" id="prescription-form-ClincImp" ></input>
          </div>
          <!-- text input -->
          <div class="col-md-9 form-group">
            <!-- <label>Text</label> -->
            <input type="text" class="form-control" placeholder="Drug" id="prescription-form-drug"></input>
            <ul class="dropdown-menu drugs-dropdown-menu">
            </ul>
          </div>
          <div class="col-md-3 form-group">
            <!-- <label>Text</label> -->
            <span class="form-control" placeholder="drug type" value="Type" id="prescription-form-drug-type"  
            style="background-color: #eee;">
          </span>
        </div>

        <div class="col-md-2 form-group">
          <!-- <label>Text</label> -->
          <input type="text" class="form-control" placeholder="Per Serving" id="prescription-form-serving">
        </input>
      </div>
      <div class="col-md-2 form-group">
        <!-- <label>Text</label> -->
        <p class="form-control" placeholder="" id="prescription-form-measurmnt" style="background-color: #eee;"> Units </p>
      </div>


      <div class="col-md-2 form-group">
        <!-- <label>Text</label> -->
        <select  class="form-control" placeholder="Days" id="prescription-form-days">
          <option name="Days">Days</option>
          <option name="Quantity">Quantity</option>

        </select>
      </div>
      <div class="col-md-1 form-group input-group spinner">
        <input type="text" class="form-control" value="1"  id="prescription-form-units"></input>
        <div class="input-group-btn-vertical">
          <button class="btn btn-default" type="button"><i class="fa fa-caret-up"></i></button>
          <button class="btn btn-default" type="button"><i class="fa fa-caret-down"></i></button>
        </div>


      </div>


      <div class="col-md-12 form-group">
        <textarea class="form-control" rows="3" placeholder="Special Instructions"  id="prescription-form-si"></textarea>
      </div>
      <div class="col-md-12 form-group">

        <input type="button" id="prescription-form-BBF" class="prescription-form-toggle-buttons col-md-1 btn btn-default btn-xs" value="BBF"></input>
        <input type="button" id="prescription-form-ABF" class="prescription-form-toggle-buttons col-md-1 btn btn-default btn-xs" value="ABF"></input>
        <input type="button" id="prescription-form-BL" class="prescription-form-toggle-buttons col-md-1 btn btn-default btn-xs" value="BL"></input>
        <input type="button" id="prescription-form-AL" class="prescription-form-toggle-buttons col-md-1 btn btn-default btn-xs" value="AL"></input>
        <input type="button" id="prescription-form-BD" class="prescription-form-toggle-buttons col-md-1 btn btn-default btn-xs" value="BD"></input>
        <input type="button" id="prescription-form-AD" class="prescription-form-toggle-buttons col-md-1 btn btn-default btn-xs" value="AD"></input>
      </div>
      <div class="col-md-12" id="prescription-form-information" style="display: none;">
        <label>Information: </label>
        <div id="prescription-form-information-text"></div>
      </div>




    </form>
  </div><!-- /.box-body -->
  <div class="box-footer" align="right">
    <button type="submit" class="btn btn-primary"  id="prescription-add">Add</button>
  </div>
</div><!-- /.box -->
</div><!--/.col (right) -->
<!-- /.row -->
</section><!-- /.content -->





<!-- Main content -->
<section class="content">
  <div class="row">
    <div class="col-xs-12">
      <div class="box box-solid box-primary">
        <div class="box-header">
          <h3 class="box-title">List of drugs</h3>
        </div><!-- /.box-header -->
        <div class="box-body">
          <table id="current-prescriptions" class="table table-bordered table-striped">
            <thead>
              <tr>
                <th>S.No</th>
                <th>BrandName</th>
                <th>Per Serving</th>
                <th>Days/Quantity</th>
                <th>Usage</th>
                <th>Remarks</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
          <div class="box-footer">
            <button type="submit" class="btn btn-primary pull-left"  id="prescription-reset-btm" >Reset</button>
            <button type="submit" class="btn btn-primary pull-right"  id="prescription-save-cont" >Save and Continue</button>
          </div>
        </div><!-- /.box-body -->
      </div><!-- /.box -->
    </div><!-- /.col -->
  </div><!-- /.row -->
</section><!-- /.content -->
</div><!-- /.content-wrapper -->
<footer class="main-footer" style="margin-left: 13%;margin-right: 22%;">
  <div class="pull-right hidden-xs">
    <b>Version</b> 1.0.0
  </div>
  <strong>Copyright &copy; 2015-2016 <a href="http://dbotica.com">Dbotica</a>.</strong> All rights reserved.
</footer>

<!-- Control Sidebar -->

<!-- Control Sidebar -->
<aside class="control-sidebar control-sidebar-light" style="position: fixed; height: auto; width: 22%;">
  <!-- Create the tabs -->
  <!-- Tab panes -->
  <p class="login-box-msg" style="margin-top: 7%;">Patient search</p>
  <form action="../../index.html" method="post" style="margin-left: 5%; margin-right: 5%; margin-bottom: 5%; 
  margin-top: 2%;">
  <div class="form-group has-feedback">
    <input type="text" class="form-control" id="patient-search-telephone" placeholder="Mobile Number">
    <span class="glyphicon glyphicon-phone form-control-feedback"></span>
  </div>
  <div class="form-group has-feedback">
    <input type="email" class="form-control" id="patient-search-uniqueid" placeholder="Dbotica Id">
    <span class="glyphicon glyphicon-envelope form-control-feedback"></span>
  </div>
  <div class="row">
    <div class="col-xs-4">
    </div><!-- /.col -->
    <div class="col-xs-4">
      <button type="submit" id="patient-search" class="btn btn-primary btn-block btn-flat">Search</button>
    </div><!-- /.col -->
  </div>
  <div class="row">
  </div>
</form>
<p class="login-box-msg" style="margin-top: 7%;"></p>
<div id="patient-search-result"></div>
</div>
</aside><!-- /.control-sidebar -->
      <!-- Add the sidebar's background. This div must be placed
      immediately after the control sidebar -->
      <div class="control-sidebar-bg"></div>
    </div><!-- ./wrapper -->

    <!--added for register pop up --->



    <!-- jQuery 2.1.4 -->
    <script src="../../plugins/jQuery/jQuery-2.1.4.min.js"></script>
    <!-- Bootstrap 3.3.5 -->
    <script src="../../bootstrap/js/bootstrap.min.js"></script>
    <script src="../../bootstrap/js/jquery.cookie.js"></script>
    <!-- FastClick -->
    <script src="../../plugins/fastclick/fastclick.min.js"></script>
    <!-- DataTables -->
    <script src="../../plugins/datatables/jquery.dataTables.min.js"></script>
    <script src="../../plugins/datatables/dataTables.bootstrap.min.js"></script>
    <!-- AdminLTE App -->
    <script src="../../dist/js/app.min.js"></script>
    <!-- AdminLTE for demo purposes -->
    <script src="../../dist/js/demo.js"></script>
	<!-- IndexedDB for local storage-->
	<script src="./indexedDB/indexedDbotica.js"></script>
	

    <script type="text/javascript">
    (function ($) {
		openDb();

      $('.spinner .btn:first-of-type').on('click', function() {
        $('.spinner input').val( parseInt($('.spinner input').val(), 10) + 1);
      });
      $('.spinner .btn:last-of-type').on('click', function() {
        if(parseInt($('.spinner input').val(), 10) != 1)
          $('.spinner input').val( parseInt($('.spinner input').val(), 10) - 1);
      });
      $('.prescription-form-toggle-buttons').click(function(e){
        var button = $(this);
        if(button.hasClass('btn-default')){
          button.removeClass('btn-default').addClass('btn-success');
        } else if(button.hasClass('btn-success')){
          button.removeClass('btn-success').addClass('btn-default');
        }
      })
    })(jQuery);

    $('#prescription-add').click(function(e){
      e.preventDefault();
      var drug = $("#prescription-form-drug").val();
      var days = $("#prescription-form-days").val();
      var units = $("#prescription-form-units").val();
      var per_serving = $("#prescription-form-serving").val();
      var msrmnt = $('#prescription-form-measurmnt').text();
    //var units = $("#prescription-form-units").val();
    var si = $("#prescription-form-si").val();
    var bbf = $("#prescription-form-BBF").hasClass('btn-success');
    var abf = $("#prescription-form-ABF").hasClass('btn-success');
    var bl = $("#prescription-form-BL").hasClass('btn-success');
    var al = $("#prescription-form-AL").hasClass('btn-success');
    var bd = $("#prescription-form-BD").hasClass('btn-success');
    var ad = $("#prescription-form-AD").hasClass('btn-success');
    var price = $("#prescription-form-price").text();
    var constituents = $("#prescription-form-constituents").text();
    var usage="" ;
    if($("#prescription-form-BBF").hasClass('btn-success'))
    {
     usage= "BBF"; 
   }
   if($("#prescription-form-ABF").hasClass('btn-success'))
   {
    if (usage == "") {
      usage= "ABF"; 
    } else {
      usage= usage +", "+"ABF"; 
    }
  }
  if($("#prescription-form-BL").hasClass('btn-success'))
  {
    if (usage == "") {
      usage= "BF"; 
    } else {
     usage= usage+", "+"BF"; 
   }
 }
 if($("#prescription-form-AL").hasClass('btn-success'))
 {
  if (usage == "") {
    usage= "AL"; 
  } else {
   usage= usage+", "+"AL";  
 }
}
if($("#prescription-form-BD").hasClass('btn-success'))
{
  if (usage == "") {
    usage= "BD"; 
  } else {
   usage= usage+", "+"BD"; 
 }
}
if($("#prescription-form-AD").hasClass('btn-success'))
{
  if (usage == "") {
    usage= "AD"; 
  } else {
   usage= usage+", "+"AD";  
 }
}

var count = $.cookie('drugEntryCount');
if (!count) {
  count = 1;
}

var drugPojoList = [];
if ($.cookie('drugPojoList') && $.cookie('drugPojoList') !== "") {
  drugPojoList = $.parseJSON($.cookie('drugPojoList'));
}
var drugPojo = {};
drugPojo['usageDirection'] = usage;
drugPojo['remarks'] = si;
drugPojo['']
drugPojo['perServing'] = per_serving;
if (days === 'Days') {
  drugPojo['noOfDays'] = units;
} else {
  drugPojo['quantity'] = units;
}

   //console.log("form submitted with values: "+drug+", "+days+", "+units+", "+si+", "+bbf+", "+abf+", "+bl+", "+al+", "+bd+", "+ad+", "+price+", "+constituents+", "+usage);
   $('#current-prescriptions > tbody').append('<tr><td>'+count+'</td><td>'+drug+'</td><td>'+per_serving+" "+msrmnt+'</td><td>'+units+" "+days+'</td><td>'+usage+'</td><td>'+si+'</td>');   
   $('#current-prescriptions').DataTable();
   $.cookie('drugHtml', $('#current-prescriptions > tbody').html());
   var countNum = Number(count);
   drugPojoList.push(drugPojo);
   $.cookie('drugPojoList',  JSON.stringify(drugPojoList));
   console.log(JSON.stringify(drugPojoList));
   countNum++;
   $.cookie('drugEntryCount', countNum);

   formClear();
 });


// var drugArray = [];
// var drugCount= 1;
// function tableToArray(drug,days,units,si,usage,constituents){
//   var tbl = $('#current-prescriptions tr').map(function() {
//     return $(this).find('td').map(function() {
//       return $(this).html();
//     }).get();
//   }).get();

//     drugArray[drugCount] = [];


//     drugArray[drugCount][0] = drug;
//     drugArray[drugCount][1] = usage;
//     drugArray[drugCount][2] = days;
//     drugArray[drugCount][3] = si;
//     drugArray[drugCount][4] = constituents;
//     drugArray[drugCount][5] = units;
//     drugCount++;
//     console.log(drugArray.length+" :drugCount :"+drugCount);



//     console.log(drugCount+ drugArray.length);

//   }
// <!--  $('#prescription-form-drug').keyup(function(e){
//       $.cookie("cookie-cli-imp",$('#prescription-form-ClincImp').val()); 
//   }); -->


$('#prescription-form-drug').keyup(function(e){
  var brandName = $('#prescription-form-drug').val();
  if (brandName === "") {
	$('.drugs-dropdown-menu').hide('dropdown');
    return;
  }
  e.preventDefault();
  $('.drugs-dropdown-menu').hide('dropdown');
  $('.drugs-dropdown-menu').empty();
  $.ajax({ 
    type: "GET",
    url: "http://localhost:8081/dbotica-spring/drug/getDrugs",
    data: {'brandName': brandName},
    success: function(response){   
      if (brandName === $('#prescription-form-drug').val()) {
        var data = $.parseJSON(response.response);                  
        console.log(data);
        var dropdown = $('.drugs-dropdown-menu');
        if(data.length != 0){
          for(var i in data){
            var drug = data[i];
            var string = drug['brandName'];
            if(drug['constituents']){
              string += " - "
              var constituents = drug['constituents'];
              for(var j in constituents){
                string += constituents[j]['molecule']+" : "+constituents[j]['weight']+",";
              }
              string = string.slice(0, -1);
            } 
            dropdown.append('<li id="'+drug['id']+'"><a href="#">'+string);
          }
          $('.drugs-dropdown-menu > li').click(function(e){
            e.preventDefault();
            $('#prescription-form-information').css('display','none');
            $('#prescription-form-information-text').empty();
            var id = $(this).get(0).id;
            for(var s in data){
              if(data[s]['id'] === id){
                console.log(data[s]);
                if(data[s]['price'])
                  if(data[s]['constituents']){
                    var constituentsString = "";
                    var constituents = data[s]['constituents'];
                    for(var c in data[s]['constituents']){
                      constituentsString += constituents[c]['molecule']+" : "+constituents[c]['weight']+",";
                    }
                    constituentsString = constituentsString.slice(0, -1);
                    $('#prescription-form-information-text').append("<li >constituents - <span id='prescription-form-constituents'>"+constituentsString+"</span></li>");
                  }
                  $('#prescription-form-information').css('display','block');
                  $('#prescription-form-drug').val(data[s]['brandName']);
                  $('#prescription-form-drug-type').text(data[s]['drugType']);
                  if(data[s]['manufacturer']=="manufacturer1")
                  {
                 // console.log("show");
                 $('#prescription-form-measurmnt').text("ml");
                 
               }else{
                  //console.log("hide");
                  $('#prescription-form-measurmnt').text("mg");
                  
                }
                break;
              }
            }

            dropdown.hide('dropdown');
          });
dropdown.show('dropdown');
}

}     
}
});  
});

$('#prescription-save-cont').click(function(e){

  var cliimp = $('#prescription-form-ClincImp').val();
  $.cookie('cookie-cli-imp',cliimp);
  var drugPojoList = $.cookie('drugPojoList');           // Object
  var json = JSON.parse(drugPojoList);
  $.cookie('currentPatientInfo-temp',$('#prescription-form-temp').val());
  $.cookie('currentPatientInfo-height', $('#prescription-form-height').val());
  $.cookie('currentPatientInfo-weight', $('#prescription-form-weight').val());
  $.cookie('currentPatientInfo-bloodPressure', $('#prescription-form-bloodPressure').val());
  $.cookie('currentPatientInfo-impression', $('#prescription-form-ClincImp').val());

  $.ajax({ 
   type: "POST",
   url: "http://localhost:8081/dbotica-spring/prescription/updatePrescription",
   beforeSend: function(xhr){
    xhr.setRequestHeader("Content-Type","application/json");
    xhr.setRequestHeader("Accept","application/json");
  },
  data: JSON.stringify({'doctorId': localStorage.getItem('doctorId'), 'drugDosage' : json, 'height': $('#prescription-form-height').val(), 'weight': $('#prescription-form-weight').val(), 'bloodPressure': $('#prescription-form-bloodPressure').val(), 'temperature': $('#prescription-form-temp').val()}),
  success: function(response){       
    alert("Prescrition successfully saved");
    var prescriptionInfo = $.parseJSON(response.response);
	//Adding prescriptioninfo to indexedDB
	var patientInfoCookie = $.cookie('currentPatientInfo');
	var patientInfo = $.parseJSON(patientInfoCookie);
	addPrescriptiontoIndexedDB(prescriptionInfo,patientInfo,localStorage.getItem('doctorId'));	
    console.log(prescriptionInfo);
    window.location.replace("../../starter.html");
  }
});
  window.location.href = 'patientReport.html';
});

$('prescription-form').submit(function(e){
 alert($(this).serializeArray());
});

$('#prescription-reset').click(function(e){
  $('#prescription-form-ClincImp').html("");
  $('#current-prescriptions > tbody').append("");
  formClear();
  $.cookie('drugHtml', "");
  $.cookie('drugEntryCount', "");
  $.cookie('currentPatientInfo-temp',"");
  $.cookie('currentPatientInfo-height',"");
  $.cookie('currentPatientInfo-weight', "");
  $.cookie('currentPatientInfo-bloodPressure', "");
  $.cookie('currentPatientInfo-impression', "");

  window.location.reload();
});

$('#prescription-reset-btm').click(function(e){
  $('#prescription-form-ClincImp').html("");
  $('#current-prescriptions > tbody').append("");
  formClear();
  $.cookie('drugHtml', "");
  $.cookie('drugEntryCount', "");
  window.location.reload();
});

$('prescription-form').submit(function(e){
 alert($(this).serializeArray());
});

$(document).ready(function(){         
  var ci = $.cookie('cookie-cli-imp');
  $('#prescription-form-ClincImp').html(ci);
  $('#current-prescriptions > tbody').append($.cookie('drugHtml'));

  //var patntPhn = $('#patient-search-telephone').val();
  //$.cookie('patientPhnCk',patntPhn);
  
});

</script>
<script>
function formClear(){

  $('#prescription-form').find('input:text').val('');
  $('#prescription-form').find('input:button').removeClass('btn-success').addClass('btn-default');
  $('#prescription-form-units').val('1');
  $('#prescription-form-drug-type').html('');
  $('#prescription-form-measurmnt').html('Qunt');
  $('#prescription-form-si').val('');
  //console.log('claered');

}
</script>
<script>
$('#patient-search').click(function(e){
 e.preventDefault();
 $('#patient-search-result').text('');

 var uniId = $("#patient-search-uniqueid").val();
 var phn = $("#patient-search-telephone").val();
 var dob = $("#patient-search-dob").val();
 $.cookie('ck-patient-phone',phn);
alert($.cookie('ck-patient-phone'));
 $.ajax({ 
  type: "GET",
  url: "http://localhost:8081/dbotica-spring/doctor/getPatients",
  data: {'patientIds': phn},
  async : false,
  success: function(response){ 
    if(response.success === true && response.response.length > 2)
    {
      var data1 = $.parseJSON(response.response);
      $.cookie('currentPatientInfo', response.response);
      $('#patient-search-result').load('registerPatient.html');
	  console.log("id of patient recived "+data1[0]);
	  addPatientObjecttoIndexedDB(data1[0]);
    } else {
      alert("Patient doesn't exist");
      $.cookie('currentPatientInfo', '');
      $('#patient-search-result').load('registerPatient.html');
      $.cookie('currentPatientContactNumber', phn);

   // $("patient-search-result").append('<input type="button" id="prescription-form-BBF" class="prescription-form-toggle-buttons col-md-1 btn btn-default btn-xs" value="BBF"></input>');
 }
updatePatientFields();
}
});
});

function updatePatientFields(){
  var data1 = $.parseJSON($.cookie('currentPatientInfo'));
  if (data1.length != 0) {
    var lastName = data1[0]['lastName'];
    if (lastName === undefined || lastName.length <= 0) {
      lastName = "";
    }

    try {
      $('#prescription-form-patient-name').text(data1[0]['firstName'] + " " + lastName);
    } catch (e) {

    }
  }
}

function resetPatientCookie(){
  $.cookie('ck-patient-name',"");
  $.cookie('ck-patient-age',"");
  $.cookie('ck-patient-gender',"");
  $.cookie('ck-patient-email',"");
  $.cookie('ck-patient-phone',"");
}

</script>
<!--  <script type="text/javascript">
  $("#modal_trigger").leanModal({top : 200, overlay : 0.6, closeButton: ".modal_close" });

  $(function(){
    // Calling Login Form
    $("#login_form").click(function(){
      $(".social_login").hide();
      $(".user_login").show();
      return false;
    });

    // Calling Register Form
    $("#register_form").click(function(){
      $(".social_login").hide();
      $(".user_register").show();
      $(".header_title").text('Register');
      return false;
    });

    // Going back to Social Forms
    $(".back_btn").click(function(){
      $(".user_login").hide();
      $(".user_register").hide();
      $(".social_login").show();
      $(".header_title").text('Login');
      return false;
    });

  })
</script> -->

</script>
</body>
</html>
